<mat-sidenav-container class="h-screen">
  <mat-sidenav mode="side" [opened]="sidebarOpen()" class="w-64 autoslider">
    <div class="px-4 py-4 text-lg font-semibold">Mi App</div>
    <mat-nav-list>
      @for (item of menuItems(); track trackByPath($index, item)) {

        <!-- Si tiene hijos, usa expansion panel -->
        <ng-container *ngIf="item.children?.length; else singleLink">
          <mat-expansion-panel>
            <mat-expansion-panel-header>
              <mat-panel-title>
                <mat-icon *ngIf="item.icon">{{ item.icon }}</mat-icon>
                <span class="ml-2">{{ item.label }}</span>
              </mat-panel-title>
            </mat-expansion-panel-header>

            <mat-nav-list>
              @for (child of item.children; track trackByPath($index, child)) {
                <a mat-list-item
                   [routerLink]="child.path"
                   routerLinkActive="active"
                   (click)="$event.stopPropagation()">
                  <mat-icon *ngIf="child.icon">{{ child.icon }}</mat-icon>
                  <span class="ml-2">{{ child.label }}</span>
                </a>
              }
            </mat-nav-list>
          </mat-expansion-panel>
        </ng-container>

        <!-- Enlace simple -->
        <ng-template #singleLink>
          <a mat-list-item
             [routerLink]="item.path"
             routerLinkActive="active">
            <mat-icon *ngIf="item.icon">{{ item.icon }}</mat-icon>
            <span class="ml-2">{{ item.label }}</span>
          </a>
        </ng-template>
      }
    </mat-nav-list>
  </mat-sidenav>

  <mat-sidenav-content>
    <mat-toolbar color="primary" class="!bg-brand-primary !text-white">
      <button mat-icon-button (click)="toggleSidebar()"><mat-icon>menu</mat-icon></button>
      <span class="ml-2" style="color: black;">Dashboard</span>
      <span class="flex-1"></span>
      <button mat-stroked-button (click)="logOut()"><mat-icon>logout</mat-icon>&nbsp;Salir</button>
    </mat-toolbar>

    <div class="p-6">
      <router-outlet></router-outlet>
    </div>
  </mat-sidenav-content>
</mat-sidenav-container>
